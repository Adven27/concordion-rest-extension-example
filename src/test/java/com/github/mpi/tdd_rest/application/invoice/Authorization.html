<html
	xmlns:c="http://www.concordion.org/2007/concordion">
<body>

	<h2>Support for Authorization</h2>
		
	<example name="Authorization">
		Given there is Invoice <b c:execute="createInvoice(#TEXT)">INV.2015.03</b> created by <b>Invoice Creator</b>
		<table class="table">
			<thead>
				<th>Action</th>
				<th>Regular User</th>
				<th>Invoice Creator</th>
				<th>Admin</th>
			</thead>
			<tbody>
				<tr>
					<td class="get"><url>/invoices/INV.2015.03</url></td>
					<td c:execute="doAsRegular()"><get/><code c:assertEquals="getStatus()">OK</code></td>
					<td c:execute="doAsCreator()"><get/><code c:assertEquals="getStatus()">OK</code></td>
					<td c:execute="doAsAdmin()"><get/><code c:assertEquals="getStatus()">OK</code></td>
				</tr>
				<tr>
					<td class="put"><span c:set="#jsonRequest"/><url>/invoices/INV.2015.03</url></td>
					<td c:execute="doAsRegular()"><put/><code c:assertEquals="getStatus()">Forbidden</code></td>
					<td c:execute="doAsCreator()"><put/><code c:assertEquals="getStatus()">OK</code></td>
					<td c:execute="doAsAdmin()"><put/><code c:assertEquals="getStatus()">OK</code></td>
				</tr>
				<tr>
					<td class="delete"><url>/invoices/INV.2015.03</url></td>
					<td c:execute="doAsRegular()"><delete/><code c:assertEquals="getStatus()">Forbidden</code></td>
					<td c:execute="doAsCreator()"><delete/><code c:assertEquals="getStatus()">Forbidden</code></td>
					<td c:execute="doAsAdmin()"><delete/><code c:assertEquals="getStatus()">OK</code></td>
				</tr>
			</tbody>
		</table>				
	</example>	
</body>
</html>