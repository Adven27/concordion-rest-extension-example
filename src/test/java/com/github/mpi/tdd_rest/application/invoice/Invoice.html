<html
	xmlns:c="http://www.concordion.org/2007/concordion">
<body>

	<h2>Invoice Endpoint</h2>
		
	<example name="Retrieving Invoice by Invoice number">
		Given there is a Invoice:
		<div class="invoice">Invoice no.: <b c:execute="#invoice = createInvoice(#TEXT)">INV.2015.01</b>
		
			Bill To:
	    	<div class="billing-details" c:execute="billTo(#invoice, #name, #address1, #address2)">
	            <b c:set="#name">Sherlock Holmes</b>
	            <b c:set="#address1">London</b>
	            <b c:set="#address2">Baker Street 221b</b>
		    </div>
		    
		    Items:
		    <table c:execute="addLineItem(#invoice, #product, #quantity, #price, #tax)">
		    	<tr>
		    		<th c:set="#product">Product</th>
		    		<th c:set="#quantity">Qty</th>
		    		<th c:set="#price">Price</th>
		    		<th c:set="#tax">Tax</th>
		    	</tr>
		    	<tr>
				     <td>Cap</td><td>1</td><td>12.49</td><td>23%</td>
		    	</tr>
		    	<tr>
				     <td>Pipe</td><td>2</td><td>5.49</td><td>23%</td>
		    	</tr>
		    </table>
    	</div>
		When I ask for resource with <get>/invoices/INV.2015.01</get>
		Then response code should be <status>HTTP/1.1 200 OK</status>
		And response body should contain:
		<responseJson>
			{
			  "invoiceNumber": "INV.2015.01",
			  "billingDetails": {
			    "contact": "Sherlock Holmes",
			    "addressLine1": "London",
			    "addressLine2": "Baker Street 221b"
			  },
			  "lineItems": [
			    {
			      "product": "Cap",
			      "quantity": 1,
			      "price": "12.49 EUR",
			      "tax": "23%"
			    },
			    {
			      "product": "Pipe",
			      "quantity": 2,
			      "price": "5.49 EUR",
			      "tax": "23%"
			    }
			  ]
			}
		</responseJson>
	</example>

	<example name="Asking for non-existing invoice">
		Given there is no Invoice with number <b>INV.2015.404</b>
		When I ask for resource with <get>/invoices/INV.2015.404</get>
		Then response code should be <status>HTTP/1.1 404 Not Found</status>
		And response body should contain:
		<responseJson>
			{
			  "errorCode": "invoice-not-found",
			  "errorMessage": "Invocie with number 'INV.2015.404' does not exist!"
			}
		</responseJson>
	</example>	
</body>
</html>